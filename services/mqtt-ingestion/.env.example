# ============================================================
# FGB MQTT Ingestion Service Configuration
# ============================================================
# This service connects to MQTT broker and writes to Supabase:
# - Raw messages → mqtt_messages_raw (audit log)
# - Normalized metrics → telemetry (long format with labels)
# ============================================================

# Supabase Configuration (REQUIRED)
# Get these from your Supabase project settings -> API -> Service Role Key
# NEVER use anon key - this service needs elevated permissions
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# MQTT Broker Configuration
MQTT_URL=mqtt://data.hub.fgb-studio.com
MQTT_PORT=1883
MQTT_USERNAME=your-mqtt-username
MQTT_PASSWORD=your-mqtt-password

# Topics to subscribe (comma-separated)
# Supported patterns:
# - bridge/+/+/reading (energy monitors - single phase)
# - bridge/+/status (bridge status)
# - fosensor/iaq (air quality sensors)
# - MSCHN/misure (3-phase energy meters)
MQTT_TOPICS=bridge/+/+/reading,bridge/+/status,fosensor/iaq,MSCHN/misure

# Default site ID for auto-registering new devices
# Devices with unknown external_id will be assigned to this "Inbox" site
# Leave empty to reject unknown devices
DEFAULT_SITE_ID=

# Batching Configuration
# Buffers are flushed when either size or interval is reached
BATCH_SIZE=100
BATCH_INTERVAL_MS=5000

# Logging
# Levels: trace, debug, info, warn, error, fatal
LOG_LEVEL=info

# Health Server Port
PORT=3001
